# Migration `20200503162910-init`

This migration has been generated by Carter Rabasa at 5/3/2020, 4:29:10 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."User" (
    "auth0Sub" text  NOT NULL ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "deletedAt" timestamp(3)   ,
    "email" text  NOT NULL ,
    "id" text  NOT NULL ,
    "productEmail" boolean  NOT NULL DEFAULT true,
    "promotionalEmail" boolean  NOT NULL DEFAULT true,
    "updatedAt" timestamp(3)   ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Connection" (
    "comment" text   ,
    "connectedId" text  NOT NULL ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "deletedAt" timestamp(3)   ,
    "id" text  NOT NULL ,
    "pin" text  NOT NULL ,
    "updatedAt" timestamp(3)   ,
    "userId" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Profile" (
    "about" text   ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "deletedAt" timestamp(3)   ,
    "id" text  NOT NULL ,
    "image" text   ,
    "location" text   ,
    "name" text  NOT NULL ,
    "nickname" text  NOT NULL ,
    "photo" text   ,
    "preview" text   ,
    "pronouns" text   ,
    "published" boolean  NOT NULL DEFAULT true,
    "updatedAt" timestamp(3)   ,
    "userId" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Tool" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "deletedAt" timestamp(3)   ,
    "description" text   ,
    "id" text  NOT NULL ,
    "kind" "ToolKind" NOT NULL ,
    "name" text  NOT NULL ,
    "updatedAt" timestamp(3)   ,
    "url" text   ,
    "verified" boolean  NOT NULL DEFAULT false,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Skill" (
    "comment" text   ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "deletedAt" timestamp(3)   ,
    "id" text  NOT NULL ,
    "level" integer  NOT NULL ,
    "profileId" text  NOT NULL ,
    "published" boolean  NOT NULL DEFAULT true,
    "toolId" text  NOT NULL ,
    "updatedAt" timestamp(3)   ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."External" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "deletedAt" timestamp(3)   ,
    "id" text  NOT NULL ,
    "nickname" text  NOT NULL ,
    "profileId" text  NOT NULL ,
    "service" text  NOT NULL ,
    "updatedAt" timestamp(3)   ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Trait" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "deletedAt" timestamp(3)   ,
    "description" text   ,
    "id" text  NOT NULL ,
    "kind" "TraitKind" NOT NULL ,
    "name" text  NOT NULL ,
    "updatedAt" timestamp(3)   ,
    "verified" boolean  NOT NULL DEFAULT false,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Preference" (
    "comment" text   ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "deletedAt" timestamp(3)   ,
    "feels" integer  NOT NULL ,
    "id" text  NOT NULL ,
    "profileId" text  NOT NULL ,
    "published" boolean  NOT NULL DEFAULT true,
    "traitId" text  NOT NULL ,
    "updatedAt" timestamp(3)   ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Place" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "deletedAt" timestamp(3)   ,
    "description" text   ,
    "id" text  NOT NULL ,
    "kind" "PlaceKind" NOT NULL ,
    "name" text  NOT NULL ,
    "updatedAt" timestamp(3)   ,
    "url" text   ,
    "verified" boolean  NOT NULL DEFAULT false,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Experience" (
    "comment" text   ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "deletedAt" timestamp(3)   ,
    "end" timestamp(3)   ,
    "id" text  NOT NULL ,
    "kind" "ExperienceKind" NOT NULL ,
    "placeId" text  NOT NULL ,
    "profileId" text  NOT NULL ,
    "published" boolean  NOT NULL DEFAULT true,
    "start" timestamp(3)  NOT NULL ,
    "title" text  NOT NULL ,
    "updatedAt" timestamp(3)   ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Activity" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "date" timestamp(3)  NOT NULL ,
    "deletedAt" timestamp(3)   ,
    "description" text   ,
    "id" text  NOT NULL ,
    "image" text   ,
    "kind" "ActivityKind" NOT NULL ,
    "profileId" text  NOT NULL ,
    "published" boolean  NOT NULL DEFAULT true,
    "title" text  NOT NULL ,
    "updatedAt" timestamp(3)   ,
    "url" text   ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."OpenGraph" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "deletedAt" timestamp(3)   ,
    "description" text   ,
    "id" text  NOT NULL ,
    "image" text   ,
    "title" text  NOT NULL ,
    "updatedAt" timestamp(3)   ,
    "url" text  NOT NULL ,
    "urlhash" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE UNIQUE INDEX "User.email" ON "public"."User"("email")

CREATE UNIQUE INDEX "Connection.userId_connectedId" ON "public"."Connection"("userId","connectedId")

CREATE UNIQUE INDEX "Profile.nickname" ON "public"."Profile"("nickname")

CREATE UNIQUE INDEX "Profile_userId" ON "public"."Profile"("userId")

CREATE UNIQUE INDEX "Tool.name" ON "public"."Tool"("name")

CREATE UNIQUE INDEX "Skill.profileId_toolId" ON "public"."Skill"("profileId","toolId")

CREATE UNIQUE INDEX "Preference.profileId_traitId" ON "public"."Preference"("profileId","traitId")

CREATE UNIQUE INDEX "Place.name" ON "public"."Place"("name")

CREATE UNIQUE INDEX "OpenGraph.url" ON "public"."OpenGraph"("url")

CREATE UNIQUE INDEX "OpenGraph.urlhash" ON "public"."OpenGraph"("urlhash")

ALTER TABLE "public"."Connection" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Connection" ADD FOREIGN KEY ("connectedId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Profile" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Skill" ADD FOREIGN KEY ("profileId")REFERENCES "public"."Profile"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Skill" ADD FOREIGN KEY ("toolId")REFERENCES "public"."Tool"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."External" ADD FOREIGN KEY ("profileId")REFERENCES "public"."Profile"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Preference" ADD FOREIGN KEY ("profileId")REFERENCES "public"."Profile"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Preference" ADD FOREIGN KEY ("traitId")REFERENCES "public"."Trait"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Experience" ADD FOREIGN KEY ("profileId")REFERENCES "public"."Profile"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Experience" ADD FOREIGN KEY ("placeId")REFERENCES "public"."Place"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Activity" ADD FOREIGN KEY ("profileId")REFERENCES "public"."Profile"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200503162910-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,228 @@
+datasource db {
+  provider = "postgresql"
+  url      = env("DATABASE_URL")
+}
+
+generator prisma_client {
+  provider = "prisma-client-js"
+}
+     
+model User {
+  id               String    @default(cuid()) @id
+  // used for Auth0 authentication
+  auth0Sub              String
+  email            String    @unique
+  productEmail     Boolean  @default(true)
+  promotionalEmail Boolean  @default(true)
+  profile          Profile?  @relation("UserProfile")
+  outboundConnections Connection[] @relation("outboundConnections")
+  inboundConnections  Connection[] @relation("inboundConnections")
+  createdAt        DateTime  @default(now())
+  updatedAt        DateTime?
+  deletedAt        DateTime?
+}
+
+model Connection {
+  id          String    @default(cuid()) @id
+  user        User      @relation("outboundConnections", fields: [userId], references: [id])
+  userId      String
+  connected   User      @relation("inboundConnections", fields: [connectedId], references: [id])
+  connectedId String
+  pin         String
+  comment     String?
+  createdAt   DateTime  @default(now())
+  updatedAt   DateTime?
+  deletedAt   DateTime?
+
+  @@unique([userId, connectedId])
+}
+
+model Profile {
+	id                	String     		@default(cuid()) @id
+	user              	User      		@relation("UserProfile", fields: [userId], references: [id])
+	userId            	String
+	nickname          	String     		@unique
+	name      					String
+	photo     					String?
+	location  					String?
+	image     					String?
+	about     					String?
+	pronouns  					String?
+	preview   					String?
+	published 					Boolean   		@default(true)
+	skills							Skill[]				@relation
+	externals						External[]		@relation
+	preferences					Preference[]	@relation
+	experiences 				Experience[]	@relation
+	activities					Activity[]		@relation
+	createdAt 					DateTime			@default(now())
+	updatedAt 					DateTime?
+	deletedAt 					DateTime?
+}
+
+enum ToolKind {
+	Language
+	Framework
+	Library
+	Device
+	Service
+	Software
+	Specialty
+}
+
+model Tool {
+	id          				String				@default(cuid()) @id
+	name        				String    		@unique
+	kind        				ToolKind
+	description 				String?
+	url         				String?
+	verified    				Boolean   		@default(false)
+	skills							Skill[]				@relation
+	createdAt   				DateTime  		@default(now())
+	updatedAt   				DateTime?
+	deletedAt   				DateTime?
+}
+
+model Skill {
+  id          				String				@default(cuid()) @id 
+	profile   					Profile   		@relation(fields: [profileId], references: [id])
+	profileId 					String
+	tool      					Tool      		@relation(fields: [toolId], references: [id])
+	toolId    					String
+	level     					Int
+	comment   					String?
+	published 					Boolean   		@default(true)
+	createdAt 					DateTime  		@default(now())
+	updatedAt 					DateTime?
+	deletedAt 					DateTime?
+
+  @@unique([profileId, toolId])
+}
+
+model External {
+	id        					String    		@default(cuid()) @id
+	profile   					Profile   		@relation(fields: [profileId], references: [id])
+	profileId 					String
+	service   					String
+	nickname  					String
+	createdAt 					DateTime  		@default(now())
+	updatedAt 					DateTime?
+	deletedAt 					DateTime?
+}
+
+enum TraitKind {
+	Role
+	Team
+	Workplace
+	Company
+}
+
+model Trait {
+	id              		String  			@default(cuid()) @id
+	kind            		TraitKind
+	name            		String
+	description     		String?
+	verified        		Boolean  			@default(false)
+	preferences					Preference[]	@relation
+	createdAt       		DateTime 			@default(now())
+	updatedAt       		DateTime?
+	deletedAt       		DateTime?
+}
+
+model Preference {
+  id          				String				@default(cuid()) @id 
+	profile      				Profile     	@relation(fields: [profileId], references: [id])
+	profileId    				String
+	trait     					Trait     		@relation(fields: [traitId], references: [id])
+	traitId   					String
+	feels     					Int
+	comment   					String?
+	published 					Boolean   		@default(true)
+	createdAt 					DateTime  		@default(now())
+	updatedAt 					DateTime?
+	deletedAt 					DateTime?
+
+	@@unique([profileId, traitId])
+}
+
+enum PlaceKind {
+	Company
+	School
+	Class
+	Bootcamp
+	Conference
+	Hackathon
+	Meetup
+}
+
+model Place {
+	id          				String       @default(cuid()) @id
+	kind        				PlaceKind
+	name        				String       @unique
+	url         				String?
+	description 				String?
+	verified    				Boolean      @default(false)
+	createdAt   				DateTime     @default(now())
+	updatedAt   				DateTime?
+	deletedAt   				DateTime?
+}
+
+enum ExperienceKind {
+	Employee
+	Student
+	Attendee
+	Speaker
+	Instructor
+	Organizer
+}
+
+model Experience {
+	id        					String         @default(cuid()) @id
+	profile      				Profile        @relation(fields: [profileId], references: [id])
+	profileId						String
+	place     					Place          @relation(fields: [placeId], references: [id])
+	placeId							String
+	kind      					ExperienceKind
+	title     					String
+	start     					DateTime
+	end       					DateTime?
+	comment   					String?
+	published  					Boolean        @default(true)
+	createdAt 					DateTime       @default(now())
+	updatedAt 					DateTime?
+	deletedAt 					DateTime?
+}
+
+enum ActivityKind {
+	Project
+	Writing
+	Video
+}
+
+model Activity {
+	id          				String       	@default(cuid()) @id
+	profile        			Profile      	@relation(fields: [profileId], references: [id])
+	profileId						String
+	kind        				ActivityKind
+	title       				String
+	description 				String?
+	image       				String?
+	url         				String?
+	date        				DateTime
+	published   				Boolean      	@default(true)
+	createdAt   				DateTime     	@default(now())
+	updatedAt   				DateTime?
+	deletedAt   				DateTime?
+}
+
+model OpenGraph {
+	id          				String    		@default(cuid()) @id
+	url         				String    		@unique
+	urlhash     				String    		@unique
+	title       				String
+	image       				String?
+	description 				String?
+	createdAt   				DateTime  		@default(now())
+	updatedAt   				DateTime?
+	deletedAt   				DateTime?
+}
```


