# Migration `20200611093933-case-insensitive-fields`

This migration has been generated by Carter Rabasa at 6/11/2020, 9:39:33 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."OpenGraph" ADD COLUMN "urlSearch" text  NOT NULL ;

ALTER TABLE "public"."Place" ADD COLUMN "nameSearch" text  NOT NULL ;

ALTER TABLE "public"."Profile" ADD COLUMN "nicknameSearch" text  NOT NULL ;

ALTER TABLE "public"."Tool" ADD COLUMN "nameSearch" text  NOT NULL ;

ALTER TABLE "public"."Trait" ADD COLUMN "nameSearch" text  NOT NULL ;

ALTER TABLE "public"."User" ADD COLUMN "emailSearch" text  NOT NULL ;

CREATE UNIQUE INDEX "OpenGraph.urlSearch" ON "public"."OpenGraph"("urlSearch")

CREATE UNIQUE INDEX "Place.nameSearch" ON "public"."Place"("nameSearch")

CREATE UNIQUE INDEX "Profile.nicknameSearch" ON "public"."Profile"("nicknameSearch")

CREATE UNIQUE INDEX "Tool.nameSearch" ON "public"."Tool"("nameSearch")

CREATE UNIQUE INDEX "Trait.name" ON "public"."Trait"("name")

CREATE UNIQUE INDEX "Trait.nameSearch" ON "public"."Trait"("nameSearch")

CREATE UNIQUE INDEX "User.emailSearch" ON "public"."User"("emailSearch")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200601074146-skill-level-optional..20200611093933-case-insensitive-fields
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator prisma_client {
   provider = "prisma-client-js"
@@ -10,8 +10,9 @@
 // Comment for User type
 model User {
   id               		String    @default(cuid()) @id
   email            		String    @unique
+  emailSearch			String		@unique
   productEmail     		Boolean  @default(true)
   promotionalEmail 		Boolean  @default(true)
   profile          		Profile?  @relation("UserProfile")
   outboundConnections 	Connection[] @relation("outboundConnections")
@@ -52,8 +53,9 @@
 	id                	String     		@default(cuid()) @id
 	user              	User      		@relation("UserProfile", fields: [userId], references: [id])
 	userId            	String
 	nickname          	String     		@unique
+	nicknameSearch		String			@unique
 	name      					String
 	photo     					String?
 	location  					String?
 	image     					String?
@@ -83,8 +85,9 @@
 model Tool {
 	id          				String			@default(cuid()) @id
 	name        				String    		@unique
+	nameSearch        			String    		@unique
 	kind        				ToolKind
 	description 				String?
 	url         				String?
 	verified    				Boolean   		@default(false)
@@ -130,12 +133,13 @@
 model Trait {
 	id              		String  			@default(cuid()) @id
 	kind            		TraitKind
-	name            		String
+	name            		String				@unique
+	nameSearch        		String    		@unique
 	description     		String?
 	verified        		Boolean  			@default(false)
-	preferences					Preference[]	@relation
+	preferences				Preference[]	@relation
 	createdAt       		DateTime 			@default(now())
 	updatedAt       		DateTime?
 	deletedAt       		DateTime?
 }
@@ -169,8 +173,9 @@
 model Place {
 	id          				String       @default(cuid()) @id
 	kind        				PlaceKind
 	name        				String       @unique
+	nameSearch        			String    	@unique
 	url         				String?
 	description 				String?
 	experiences					Experience[] @relation
 	verified    				Boolean      @default(false)
@@ -229,8 +234,9 @@
 model OpenGraph {
 	id          				String    		@default(cuid()) @id
 	url         				String    		@unique
+	urlSearch        			String    		@unique
 	urlhash     				String    		@unique
 	title       				String
 	image       				String?
 	description 				String?
```


